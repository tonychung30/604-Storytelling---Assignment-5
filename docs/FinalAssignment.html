<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tony Chung">
<meta name="dcterms.date" content="2025-12-09">

<title>Final Assignment – Tony Chung - 604 Assignment 5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Tony Chung - 604 Assignment 5</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./604 Storytelling - Assignment 5.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./FinalAssignment.html" aria-current="page"> 
<span class="menu-text">Final Assignment</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/tonychung30/604-Storytelling---Assignment-5" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#final-assignment" id="toc-final-assignment" class="nav-link active" data-scroll-target="#final-assignment">Final Assignment</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Assignment</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tony Chung </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 9, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="final-assignment" class="level2">
<h2 class="anchored" data-anchor-id="final-assignment">Final Assignment</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstatix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks rstatix::filter(), stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(descr)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(labelled)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'car' was built under R version 4.4.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData

Attaching package: 'car'

The following object is masked from 'package:dplyr':

    recode

The following object is masked from 'package:purrr':

    some

Loading required package: effects
lattice theme set by effectsTheme()
See ?effectsTheme for details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smss)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggeffects' was built under R version 4.4.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: 

 Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.
 R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"UN11"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(UN11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        region  group fertility    ppgdp
Afghanistan                               Asia  other  5.968000    499.0
Albania                                 Europe  other  1.525000   3677.2
Algeria                                 Africa africa  2.142000   4473.0
Angola                                  Africa africa  5.135000   4321.9
Anguilla                             Caribbean  other  2.000000  13750.1
Argentina                           Latin Amer  other  2.172000   9162.1
Armenia                                   Asia  other  1.735000   3030.7
Aruba                                Caribbean  other  1.671000  22851.5
Australia                              Oceania   oecd  1.949000  57118.9
Austria                                 Europe   oecd  1.346000  45158.8
Azerbaijan                                Asia  other  2.148000   5637.6
Bahamas                              Caribbean  other  1.877000  22461.6
Bahrain                                   Asia  other  2.430000  18184.1
Bangladesh                                Asia  other  2.157000    670.4
Barbados                             Caribbean  other  1.575000  14497.3
Belarus                                 Europe  other  1.479000   5702.0
Belgium                                 Europe   oecd  1.835000  43814.8
Belize                              Latin Amer  other  2.679000   4495.8
Benin                                   Africa africa  5.078000    741.1
Bermuda                              Caribbean  other  1.760000  92624.7
Bhutan                                    Asia  other  2.258000   2047.2
Bolivia                             Latin Amer  other  3.229000   1977.9
Bosnia and Herzegovina                  Europe  other  1.134000   4477.7
Botswana                                Africa africa  2.617000   7402.9
Brazil                              Latin Amer  other  1.800000  10715.6
Brunei Darussalam                         Asia  other  1.984000  32647.6
Bulgaria                                Europe  other  1.546000   6365.1
Burkina Faso                            Africa africa  5.750000    519.7
Burundi                                 Africa africa  4.051000    176.6
Cambodia                                  Asia  other  2.422000    797.2
Cameroon                                Africa africa  4.287000   1206.6
Canada                           North America   oecd  1.691000  46360.9
Cape Verde                              Africa africa  2.279000   3244.0
Cayman Islands                       Caribbean  other  1.600000  57047.9
Central African Republic                Africa africa  4.423000    450.8
Chad                                    Africa africa  5.737000    727.4
Chile                               Latin Amer   oecd  1.832000  11887.7
China                                     Asia  other  1.559000   4354.0
Colombia                            Latin Amer  other  2.293000   6222.8
Comoros                                 Africa africa  4.742000    736.6
Congo                                   Africa africa  4.442000   2665.1
Cook Islands                           Oceania  other  2.530806  12212.1
Costa Rica                          Latin Amer  other  1.812000   7703.8
Cote dIvoire                            Africa africa  4.224000   1154.1
Croatia                                 Europe  other  1.501000  13819.5
Cuba                                 Caribbean  other  1.451000   5704.4
Cyprus                                    Asia  other  1.458000  28364.3
Czech Republic                          Europe   oecd  1.501000  18838.8
Democratic Republic of the Congo        Africa africa  5.485000    200.6
Denmark                                 Europe   oecd  1.885000  55830.2
Djibouti                                Africa africa  3.589000   1282.6
Dominica                             Caribbean  other  3.000000   7020.8
Dominican Republic                   Caribbean  other  2.490000   5195.4
East Timor                                Asia  other  5.918000    706.1
Ecuador                             Latin Amer  other  2.393000   4072.6
Egypt                                   Africa africa  2.636000   2653.7
El Salvador                         Latin Amer  other  2.171000   3425.6
Equatorial Guinea                       Africa africa  4.980000  16852.4
Eritrea                                 Africa africa  4.243000    429.1
Estonia                                 Europe   oecd  1.702000  14135.4
Ethiopia                                Africa africa  3.848000    324.6
Fiji                                   Oceania  other  2.602000   3545.7
Finland                                 Europe   oecd  1.875000  44501.7
France                                  Europe   oecd  1.987000  39545.9
French Polynesia                       Oceania  other  2.033000  24669.0
Gabon                                   Africa africa  3.195000  12468.8
Gambia                                  Africa africa  4.689000    579.1
Georgia                                   Asia  other  1.528000   2680.3
Germany                                 Europe   oecd  1.457000  39857.1
Ghana                                   Africa africa  3.988000   1333.2
Greece                                  Europe   oecd  1.540000  26503.8
Greenland                        NorthAtlantic  other  2.217000  35292.7
Grenada                              Caribbean  other  2.171000   7429.0
Guatemala                           Latin Amer  other  3.840000   2882.3
Guinea                                  Africa africa  5.032000    427.5
Guinea-Bissau                           Africa africa  4.877000    539.4
Guyana                              Latin Amer  other  2.190000   2996.0
Haiti                                Caribbean  other  3.159000    612.7
Honduras                            Latin Amer  other  2.996000   2026.2
Hong Kong                                 Asia  other  1.137000  31823.7
Hungary                                 Europe   oecd  1.430000  12884.0
Iceland                                 Europe  other  2.098000  39278.0
India                                     Asia  other  2.538000   1406.4
Indonesia                                 Asia  other  2.055000   2949.3
Iran                                      Asia  other  1.587000   5227.1
Iraq                                      Asia  other  4.535000    888.5
Ireland                                 Europe   oecd  2.097000  46220.3
Israel                                    Asia   oecd  2.909000  29311.6
Italy                                   Europe   oecd  1.476000  33877.1
Jamaica                              Caribbean  other  2.262000   4899.0
Japan                                     Asia   oecd  1.418000  43140.9
Jordan                                    Asia  other  2.889000   4445.3
Kazakhstan                                Asia  other  2.481000   9166.7
Kenya                                   Africa africa  4.623000    801.8
Kiribati                               Oceania  other  3.500000   1468.2
Kuwait                                    Asia  other  2.251000  45430.4
Kyrgyzstan                                Asia  other  2.621000    865.4
Laos                                      Asia  other  2.543000   1047.6
Latvia                                  Europe  other  1.506000  10663.0
Lebanon                                   Asia  other  1.764000   9283.7
Lesotho                                 Africa africa  3.051000    980.7
Liberia                                 Africa africa  5.038000    218.6
Libya                                   Africa africa  2.410000  11320.8
Lithuania                               Europe  other  1.495000  10975.5
Luxembourg                              Europe   oecd  1.683000 105095.4
Macao                                     Asia  other  1.163000  49990.2
Madagascar                              Africa africa  4.493000    421.9
Malawi                                  Africa africa  5.968000    357.4
Malaysia                                  Asia  other  2.572000   8372.8
Maldives                                  Asia  other  1.668000   4684.5
Mali                                    Africa africa  6.117000    598.8
Malta                                   Europe  other  1.284000  19599.2
Marshall Islands                       Oceania  other  4.384466   3069.4
Mauritania                              Africa africa  4.361000   1131.1
Mauritius                               Africa africa  1.590000   7488.3
Mexico                              Latin Amer   oecd  2.227000   9100.7
Micronesia                             Oceania  other  3.307000   2678.2
Moldova                                 Europe  other  1.450000   1625.8
Mongolia                                  Asia  other  2.446000   2246.7
Montenegro                              Europe  other  1.630000   6509.8
Morocco                                 Africa africa  2.183000   2865.0
Mozambique                              Africa africa  4.713000    407.5
Myanmar                                   Asia  other  1.939000    876.2
Namibia                                 Africa africa  3.055000   5124.7
Nauru                                  Oceania  other  3.300000   6190.1
Nepal                                     Asia  other  2.587000    534.7
Neth Antilles                        Caribbean  other  1.900000  20321.1
Netherlands                             Europe   oecd  1.794000  46909.7
New Caledonia                          Oceania  other  2.091000  35319.5
New Zealand                            Oceania   oecd  2.135000  32372.1
Nicaragua                           Latin Amer  other  2.500000   1131.9
Niger                                   Africa africa  6.925000    357.7
Nigeria                                 Africa africa  5.431000   1239.8
North Korea                               Asia  other  1.988000    504.0
Norway                                  Europe   oecd  1.948000  84588.7
Oman                                      Asia  other  2.146000  20791.0
Pakistan                                  Asia  other  3.201000   1003.2
Palau                                  Oceania  other  2.000000  10821.8
Palestinian Territory                     Asia  other  4.270000   1819.5
Panama                              Latin Amer  other  2.409000   7614.0
Papua New Guinea                       Oceania  other  3.799000   1428.4
Paraguay                            Latin Amer  other  2.858000   2771.1
Peru                                Latin Amer  other  2.410000   5410.7
Philippines                               Asia  other  3.050000   2140.1
Poland                                  Europe   oecd  1.415000  12263.2
Portugal                                Europe   oecd  1.312000  21437.6
Puerto Rico                          Caribbean  other  1.757000  26461.0
Qatar                                     Asia  other  2.204000  72397.9
Republic of Korea                         Asia  other  1.389000  21052.2
Romania                                 Europe  other  1.428000   7522.4
Russian Federation                      Europe  other  1.529000  10351.4
Rwanda                                  Africa africa  5.282000    532.3
Saint Lucia                          Caribbean  other  1.907000   6677.1
Samoa                                  Oceania  other  3.763000   3343.3
Sao Tome and Principe                   Africa africa  3.488000   1283.3
Saudi Arabia                              Asia  other  2.639000  15835.9
Senegal                                 Africa africa  4.605000   1032.7
Serbia                                  Europe  other  1.562000   5123.2
Seychelles                              Africa africa  2.340000  11450.6
Sierra Leone                            Africa africa  4.728000    351.7
Singapore                                 Asia  other  1.367000  43783.1
Slovakia                                Europe   oecd  1.372000  15976.0
Slovenia                                Europe   oecd  1.477000  23109.8
Solomon Islands                        Oceania  other  4.041000   1193.5
Somalia                                 Africa africa  6.283000    114.8
South Africa                            Africa africa  2.383000   7254.8
Spain                                   Europe  other  1.504000  30542.8
Sri Lanka                                 Asia  other  2.235000   2375.3
St Vincent and Grenadines            Caribbean  other  1.995000   6171.7
Sudan                                   Africa africa  4.225000   1824.9
Suriname                            Latin Amer  other  2.266000   7018.0
Swaziland                               Africa africa  3.174000   3311.2
Sweden                                  Europe   oecd  1.925000  48906.2
Switzerland                             Europe   oecd  1.536000  68880.2
Syria                                     Asia  other  2.772000   2931.5
Tajikistan                                Asia  other  3.162000    816.0
Tanzania                                Africa africa  5.499000    516.0
TFYR Macedonia                          Europe  other  1.397000   4434.5
Thailand                                  Asia  other  1.528000   4612.8
Togo                                    Africa africa  3.864000    524.6
Tonga                                  Oceania  other  3.783000   3543.1
Trinidad and Tobago                  Caribbean  other  1.632000  15205.1
Tunisia                                 Africa africa  1.909000   4222.1
Turkey                                    Asia   oecd  2.022000  10095.1
Turkmenistan                              Asia  other  2.316000   4587.5
Tuvalu                                 Oceania  other  3.700000   3187.2
Uganda                                  Africa africa  5.901000    509.0
Ukraine                                 Europe  other  1.483000   3035.0
United Arab Emirates                      Asia  other  1.707000  39624.7
United Kingdom                          Europe   oecd  1.867000  36326.8
United States                    North America   oecd  2.077000  46545.9
Uruguay                             Latin Amer  other  2.043000  11952.4
Uzbekistan                                Asia  other  2.264000   1427.3
Vanuatu                                Oceania  other  3.750000   2963.5
Venezuela                           Latin Amer  other  2.391000  13502.7
Viet Nam                                  Asia  other  1.750000   1182.7
Yemen                                     Asia  other  4.938000   1437.2
Zambia                                  Africa africa  6.300000   1237.8
Zimbabwe                                Africa africa  3.109000    573.1
                                 lifeExpF pctUrban
Afghanistan                      49.49000       23
Albania                          80.40000       53
Algeria                          75.00000       67
Angola                           53.17000       59
Anguilla                         81.10000      100
Argentina                        79.89000       93
Armenia                          77.33000       64
Aruba                            77.75000       47
Australia                        84.27000       89
Austria                          83.55000       68
Azerbaijan                       73.66000       52
Bahamas                          78.85000       84
Bahrain                          76.06000       89
Bangladesh                       70.23000       29
Barbados                         80.26000       45
Belarus                          76.37000       75
Belgium                          82.81000       97
Belize                           77.81000       53
Benin                            58.66000       42
Bermuda                          82.30000      100
Bhutan                           69.84000       35
Bolivia                          69.40000       67
Bosnia and Herzegovina           78.40000       49
Botswana                         51.34000       62
Brazil                           77.41000       87
Brunei Darussalam                80.64000       76
Bulgaria                         77.12000       72
Burkina Faso                     57.02000       27
Burundi                          52.58000       11
Cambodia                         65.10000       20
Cameroon                         53.56000       59
Canada                           83.49000       81
Cape Verde                       77.70000       62
Cayman Islands                   83.80000      100
Central African Republic         51.30000       39
Chad                             51.61000       28
Chile                            82.35000       89
China                            75.61000       48
Colombia                         77.69000       75
Comoros                          63.18000       28
Congo                            59.33000       63
Cook Islands                     76.24547       76
Costa Rica                       81.99000       65
Cote dIvoire                     57.71000       51
Croatia                          80.37000       58
Cuba                             81.33000       75
Cyprus                           82.14000       71
Czech Republic                   81.00000       74
Democratic Republic of the Congo 50.56000       36
Denmark                          81.37000       87
Djibouti                         60.04000       76
Dominica                         78.20000       67
Dominican Republic               76.57000       70
East Timor                       64.20000       29
Ecuador                          78.91000       68
Egypt                            75.52000       44
El Salvador                      77.09000       65
Equatorial Guinea                52.91000       40
Eritrea                          64.41000       22
Estonia                          79.95000       70
Ethiopia                         61.59000       17
Fiji                             72.27000       52
Finland                          83.28000       85
France                           84.90000       86
French Polynesia                 78.07000       51
Gabon                            64.32000       86
Gambia                           60.30000       59
Georgia                          77.31000       53
Germany                          82.99000       74
Ghana                            65.80000       52
Greece                           82.58000       62
Greenland                        71.60000       84
Grenada                          77.72000       40
Guatemala                        75.10000       50
Guinea                           56.39000       36
Guinea-Bissau                    50.40000       30
Guyana                           73.45000       29
Haiti                            63.87000       54
Honduras                         75.92000       52
Hong Kong                        86.35000      100
Hungary                          78.47000       68
Iceland                          83.77000       94
India                            67.62000       30
Indonesia                        71.80000       45
Iran                             75.28000       71
Iraq                             72.60000       66
Ireland                          83.17000       62
Israel                           84.19000       92
Italy                            84.62000       69
Jamaica                          75.98000       52
Japan                            87.12000       67
Jordan                           75.17000       79
Kazakhstan                       72.84000       59
Kenya                            59.16000       23
Kiribati                         63.10000       44
Kuwait                           75.89000       98
Kyrgyzstan                       72.36000       35
Laos                             69.42000       34
Latvia                           78.51000       68
Lebanon                          75.07000       87
Lesotho                          48.11000       28
Liberia                          58.59000       48
Libya                            77.86000       78
Lithuania                        78.28000       67
Luxembourg                       82.67000       85
Macao                            83.80000      100
Madagascar                       68.61000       31
Malawi                           55.17000       20
Malaysia                         76.86000       73
Maldives                         78.70000       41
Mali                             53.14000       37
Malta                            82.29000       95
Marshall Islands                 70.60000       72
Mauritania                       60.95000       42
Mauritius                        76.89000       42
Mexico                           79.64000       78
Micronesia                       70.17000       23
Moldova                          73.48000       48
Mongolia                         72.83000       63
Montenegro                       77.37000       61
Morocco                          74.86000       59
Mozambique                       51.81000       39
Myanmar                          67.87000       34
Namibia                          63.04000       39
Nauru                            57.10000      100
Nepal                            70.05000       19
Neth Antilles                    79.86000       93
Netherlands                      82.79000       83
New Caledonia                    80.49000       57
New Zealand                      82.77000       86
Nicaragua                        77.45000       58
Niger                            55.77000       17
Nigeria                          53.38000       51
North Korea                      72.12000       60
Norway                           83.47000       80
Oman                             76.44000       73
Pakistan                         66.88000       36
Palau                            72.10000       84
Palestinian Territory            74.81000       74
Panama                           79.07000       75
Papua New Guinea                 65.52000       13
Paraguay                         74.91000       62
Peru                             76.90000       77
Philippines                      72.57000       49
Poland                           80.56000       61
Portugal                         82.76000       61
Puerto Rico                      83.20000       99
Qatar                            78.24000       96
Republic of Korea                83.95000       83
Romania                          77.95000       58
Russian Federation               75.01000       73
Rwanda                           57.13000       19
Saint Lucia                      77.54000       28
Samoa                            76.02000       20
Sao Tome and Principe            66.48000       63
Saudi Arabia                     75.57000       82
Senegal                          60.92000       43
Serbia                           77.05000       56
Seychelles                       78.00000       56
Sierra Leone                     48.87000       39
Singapore                        83.71000      100
Slovakia                         79.53000       55
Slovenia                         82.84000       49
Solomon Islands                  70.00000       19
Somalia                          53.38000       38
South Africa                     54.09000       62
Spain                            84.76000       78
Sri Lanka                        78.40000       14
St Vincent and Grenadines        74.73000       50
Sudan                            63.82000       41
Suriname                         74.18000       70
Swaziland                        48.54000       21
Sweden                           83.65000       85
Switzerland                      84.71000       74
Syria                            77.72000       56
Tajikistan                       71.23000       26
Tanzania                         60.31000       27
TFYR Macedonia                   77.14000       59
Thailand                         77.76000       34
Togo                             59.40000       44
Tonga                            75.38000       24
Trinidad and Tobago              73.82000       14
Tunisia                          77.05000       68
Turkey                           76.61000       70
Turkmenistan                     69.40000       50
Tuvalu                           65.10000       51
Uganda                           55.44000       13
Ukraine                          74.58000       69
United Arab Emirates             78.02000       84
United Kingdom                   82.42000       80
United States                    81.31000       83
Uruguay                          80.66000       93
Uzbekistan                       71.90000       36
Vanuatu                          73.58000       26
Venezuela                        77.73000       94
Viet Nam                         77.44000       31
Yemen                            67.66000       32
Zambia                           50.04000       36
Zimbabwe                         52.72000       39</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> UN11[, <span class="fu">sapply</span>(UN11, is.numeric)]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (var <span class="cf">in</span> <span class="fu">names</span>(cv)) {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(UN11, <span class="fu">aes_string</span>(<span class="at">x =</span> var)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"white"</span>,<span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(var), <span class="at">x =</span> var, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dark</span>() <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hist) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the histograms of the continuous variables, fertility and ppgdp results are a bit skewed. Fertility reports back negatives in a weird way and ppgdp is too spread out. Through inspection, I decided to log transform these two continuous variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>UN11<span class="sc">$</span>log_fertility <span class="ot">&lt;-</span> <span class="fu">log1p</span>(UN11<span class="sc">$</span>fertility)  </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>UN11<span class="sc">$</span>log_ppgdp <span class="ot">&lt;-</span> <span class="fu">log1p</span>(UN11<span class="sc">$</span>ppgdp)        </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(UN11, <span class="fu">aes</span>(<span class="at">x =</span> log_fertility)) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Log Transformed Fertility"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Log Fertility"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(UN11, <span class="fu">aes</span>(<span class="at">x =</span> log_ppgdp)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Log-Transformed PPGDP"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Log PPGDP"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(lifeExpF <span class="sc">~</span> group, <span class="at">data =</span> UN11)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
group         2  12563    6282   159.3 &lt;2e-16 ***
Residuals   196   7730      39                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>posthoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(posthoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = lifeExpF ~ group, data = UN11)

$group
                   diff       lwr        upr p adj
other-oecd    -7.119708 -10.12115  -4.118263 2e-07
africa-oecd  -22.674187 -26.02774 -19.320639 0e+00
africa-other -15.554479 -18.01684 -13.092119 0e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(posthoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The result of the ANOVA test shows that the P-Value is &lt;0.05, therefore we would reject the null hypothesis. In this case, this means that the groups have major difference in life expectancy since we are rejecting the null hypothesis.</p>
<p>In the plot of the Tukey test, you can see the mean is different for each group, signifying that there is significant difference between the groups.</p>
<p>3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">cor</span>(cv, <span class="at">use =</span> <span class="st">"complete.obs"</span>, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           fertility      ppgdp   lifeExpF   pctUrban
fertility  1.0000000 -0.4399891 -0.8235881 -0.5429847
ppgdp     -0.4399891  1.0000000  0.5489596  0.5983085
lifeExpF  -0.8235881  0.5489596  1.0000000  0.6013320
pctUrban  -0.5429847  0.5983085  0.6013320  1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(cm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>According to the Week 2 lecture slides, the size of correlation is as follows: +-.9 to 1.0 is very high correlation, +-.7 to .9 is high correlation, +-.5 to .7 is moderate correlation, +-.3 to .5 is low correlation and +-.0 to .3 is negligible correlation. In relation to the continuous variables, fertility and ppgdp has a moderate negative correlation, meaning fertility has moderate impact on ppgdp. Fertility and lifeExpF has a high negative correlation, meaning fertility has a high impact on life expectancy. These are all listed in the summary, but to summarize, a positive correlation means they are more closely related, while negative is the opposite.</p>
<p>4.</p>
<p>Fertility and life expectancy have a high negative correlation (meaning lower life expectancy), so a hypothesis could be countries with higher fertility rates have worse or not as developed healthcare systems.</p>
<p>PctUrban (Urban percent) and life expectancy have a moderate positive correlation, meaning urban areas are more likely to have a higher life expectancy. A hypothesis could be that urban areas are further developed and have better healthcare systems.</p>
<p>PPGDP and life expectancy have a moderate positive correlation, meaning higher gdp is tied into a higher life expectancy. A hypothesis for this could be that wealthier areas and countries have more money to spend on better healthcare and services.</p>
<p>I will incorporate region but not group in my model, as I think it is important to see the region associated with the DV. The group however, is not relevant as it is not specific enough (Africa or unspecified country).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#head(UN11)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  lifeExpF <span class="sc">~</span> fertility <span class="sc">+</span> pctUrban <span class="sc">+</span> ppgdp <span class="sc">+</span> region,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> UN11)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExpF ~ fertility + pctUrban + ppgdp + region, 
    data = UN11)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.3038  -2.1467   0.4144   2.3347  10.4442 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          7.232e+01  2.141e+00  33.781  &lt; 2e-16 ***
fertility           -3.469e+00  3.856e-01  -8.995 2.56e-16 ***
pctUrban             4.472e-02  1.982e-02   2.256 0.025238 *  
ppgdp                9.385e-05  2.473e-05   3.795 0.000199 ***
regionAsia           6.979e+00  1.122e+00   6.220 3.15e-09 ***
regionCaribbean      7.950e+00  1.530e+00   5.196 5.27e-07 ***
regionEurope         8.159e+00  1.405e+00   5.805 2.69e-08 ***
regionLatin Amer     9.744e+00  1.407e+00   6.924 6.75e-11 ***
regionNorth America  8.584e+00  3.523e+00   2.437 0.015754 *  
regionNorthAtlantic -1.033e-01  4.761e+00  -0.022 0.982715    
regionOceania        7.473e+00  1.360e+00   5.496 1.25e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.627 on 188 degrees of freedom
Multiple R-squared:  0.8017,    Adjusted R-squared:  0.7911 
F-statistic:    76 on 10 and 188 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: not plotting observations with leverage one:
  72</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(ols))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(ols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">resid</span>(ols), <span class="at">main =</span> <span class="st">"Residuals"</span>, <span class="at">xlab =</span> <span class="st">"Residuals"</span>, <span class="at">ylab =</span> <span class="st">"Freq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  ols
BP = 39.354, df = 10, p-value = 2.201e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              GVIF Df GVIF^(1/(2*Df))
fertility 2.468385  1        1.571110
pctUrban  1.995567  1        1.412645
ppgdp     1.917385  1        1.384697
region    2.698229  7        1.073474</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>cooksd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(ols)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(cooksd, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">"Cook's Distance"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">5</span> <span class="sc">/</span> <span class="fu">nrow</span>(UN11), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#OLS assumptions</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Normality - this is normal as most of the points fall along the diagonal line in the Q-Q Residuals plot.</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Homoscedasticity - there is no cone shape in Scale-Location, therfore no homoscedasticity.</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Multicollinearity - none of the VIFs are over 5, so there is not multicollinearity.</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Outliers (Cook's Distance) - Using Cook's distance plot, you can see there is 1 clear outlier (greater than 1.0).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>new_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  lifeExpF <span class="sc">~</span> <span class="fu">log</span>(fertility) <span class="sc">+</span> pctUrban <span class="sc">+</span> <span class="fu">log</span>(ppgdp) <span class="sc">+</span> region,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> UN11</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(new_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExpF ~ log(fertility) + pctUrban + log(ppgdp) + 
    region, data = UN11)

Residuals:
     Min       1Q   Median       3Q      Max 
-16.0436  -1.9117   0.2199   2.1569  11.9860 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         57.00744    3.72952  15.285  &lt; 2e-16 ***
log(fertility)      -8.50104    1.29896  -6.545 5.52e-10 ***
pctUrban             0.01796    0.02158   0.832   0.4063    
log(ppgdp)           1.95753    0.41272   4.743 4.15e-06 ***
regionAsia           7.01868    1.09270   6.423 1.06e-09 ***
regionCaribbean      7.32965    1.50471   4.871 2.35e-06 ***
regionEurope         7.10807    1.42551   4.986 1.39e-06 ***
regionLatin Amer     9.76534    1.33842   7.296 8.06e-12 ***
regionNorth America  8.22351    3.42135   2.404   0.0172 *  
regionNorthAtlantic -0.64608    4.65132  -0.139   0.8897    
regionOceania        6.89041    1.35298   5.093 8.54e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.512 on 188 degrees of freedom
Multiple R-squared:  0.8114,    Adjusted R-squared:  0.8014 
F-statistic: 80.89 on 10 and 188 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(new_model, <span class="at">type =</span> <span class="st">"text"</span>,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"OLS Regression"</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels =</span> <span class="fu">c</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Log Fertility"</span>, <span class="st">"Urbanization %"</span>, <span class="st">"Log GDP"</span>, <span class="st">"Region"</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">dep.var.labels =</span> <span class="st">"Life Expectancy"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">out =</span> <span class="st">"regression_table.txt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
OLS Regression
===============================================
                        Dependent variable:    
                    ---------------------------
                          Life Expectancy      
-----------------------------------------------
Log Fertility                -8.501***         
                              (1.299)          
                                               
Urbanization %                 0.018           
                              (0.022)          
                                               
Log GDP                      1.958***          
                              (0.413)          
                                               
Region                       7.019***          
                              (1.093)          
                                               
regionCaribbean              7.330***          
                              (1.505)          
                                               
regionEurope                 7.108***          
                              (1.426)          
                                               
regionLatin Amer             9.765***          
                              (1.338)          
                                               
regionNorth America           8.224**          
                              (3.421)          
                                               
regionNorthAtlantic           -0.646           
                              (4.651)          
                                               
regionOceania                6.890***          
                              (1.353)          
                                               
Constant                     57.007***         
                              (3.730)          
                                               
-----------------------------------------------
Observations                    199            
R2                             0.811           
Adjusted R2                    0.801           
Residual Std. Error      4.512 (df = 188)      
F Statistic          80.886*** (df = 10; 188)  
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<ol start="5" type="1">
<li><p>In the model, the beta weights for urbanization %, log GDP and region are all positive, while log fertility is a negative beta weight. The significance for each of these (using p&lt;0.05 as significant), is log fertility, log GDP and region (mostly) are all significant, meaning these independent variables all impact the DV. Fertility is significant negatively tied to life expectancy as regions with higher fertility rates may have less healthcare access, meaning their life expectancies are not as high. Surprising to me, urban % does not have a significant impact on life expectancy. This could be due to the data of the regions; maybe if I had included “group” this p-value might have changed. Log gdp and life expectancy has a significant positive correlation as people from regions with more money have better access to healthcare and can afford better healthcare services generally speaking. The significance of the Caribbean, Europe, Latin America, North America and Oceania are all significant; while North Atlantic is not.</p>
<p>As for model fit statistics, it is 0.8114, so this is generally a good and accurate model as you want this number as close to 1 as possible. There could be some factors that make this model inaccurate, which is why it’s only 0.8114.</p>
<p>This OLS model explains that higher fertility is correlated in lower life expectancy, urban percentage is slightly positivley correlated to life expectancy (however this might not be significant), higher GDP is correlated with higher life expectancy, and region plays a factor in life expectancy (Caribbean, Europe, Latin America, North America and Oceania are all significant).</p></li>
</ol>
<p>6.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fertility <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(new_model, <span class="at">terms =</span> <span class="st">"fertility"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>urban <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(new_model, <span class="at">terms =</span> <span class="st">"pctUrban"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>ppgdp <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(new_model, <span class="at">terms =</span> <span class="st">"ppgdp"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(new_model, <span class="at">terms =</span> <span class="st">"region"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>fertility_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fertility, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life Expectancy by Fertility"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fertility"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy"</span>) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>urban_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(urban, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life Expectancy by Urban %"</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Urban %"</span>,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy"</span>) <span class="sc">+</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>ppgdp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ppgdp, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted)) <span class="sc">+</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life Expectancy by GDP"</span>,</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"GDP"</span>,</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy"</span>) <span class="sc">+</span></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>region_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(region, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted, <span class="at">fill =</span> x)) <span class="sc">+</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high), <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lightblue"</span>, <span class="st">"blue"</span>, <span class="st">"darkblue"</span>, <span class="st">"cyan"</span>, <span class="st">"purple"</span>,<span class="st">"lavender"</span>,<span class="st">"grey"</span>,<span class="st">"pink"</span> )) <span class="sc">+</span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life Expectancy in Regions"</span>,</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Region"</span>,</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">" Expectancy"</span>) <span class="sc">+</span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>()</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>fertility_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>urban_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ppgdp_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_ribbon()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>region_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="FinalAssignment_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Life Expectancy by Fertility</p>
<ul>
<li>Shows the correlation between a higher fertility relates to a lower life expectancy.</li>
</ul>
<p>Life Expectancy by Urban %</p>
<ul>
<li>Shows a positive correlation between higher urban percentage and life expectancy.</li>
</ul>
<p>Life Expectancy by GDP</p>
<ul>
<li>Shows the correlation between higher GDP relates to higher life expectancy.</li>
</ul>
<p>Life Expectancy in Regions</p>
<ul>
<li>Shows the general mean life expectancy in specific regions.</li>
</ul>
<ol start="7" type="1">
<li>The factors that are influential in life expectancy are fertility, urban percentage, and GDP. Fertility is highly negatively impacts life expectancy. Urban percentage has a slight positive impact, however not significant. This could be due to the city within the region and fertility/GDP factors within the city itself. GDP greatly positively impacts life expectancy as the more wealth a region has, the more money it can spend of healthcare and factors associated with long-term health (better food, better infrastructure, better access to healthcare, etc.).</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Erico Yu. All rights reserved.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>